(function(t){function e(e){for(var r,n,o=e[0],c=e[1],u=e[2],l=0,d=[];l<o.length;l++)n=o[l],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);p&&p(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,n=1;n<a.length;n++){var o=a[n];0!==s[o]&&(r=!1)}r&&(i.splice(e--,1),t=c(c.s=a[0]))}return t}var r={},n={app:0},s={app:0},i=[];function o(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-1933fae3":"ba36b070","chunk-288c86ad":"c507035a","chunk-2916cf79":"cb8e62b1","chunk-50debbf1":"75d14304","chunk-5d7013b8":"0906955b","chunk-5f425161":"c20ad53c","chunk-5f440c2f":"00c7a84c","chunk-69835417":"b079be9d","chunk-6db783c9":"bef21361","chunk-824041fa":"58be7cc2","chunk-8558012c":"aee70e28"}[t]+".js"}function c(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(t){var e=[],a={"chunk-1933fae3":1,"chunk-288c86ad":1,"chunk-2916cf79":1,"chunk-50debbf1":1,"chunk-5d7013b8":1,"chunk-5f425161":1,"chunk-5f440c2f":1,"chunk-69835417":1,"chunk-6db783c9":1,"chunk-824041fa":1,"chunk-8558012c":1};n[t]?e.push(n[t]):0!==n[t]&&a[t]&&e.push(n[t]=new Promise((function(e,a){for(var r="css/"+({}[t]||t)+"."+{"chunk-1933fae3":"c36faa98","chunk-288c86ad":"8f5809ae","chunk-2916cf79":"b10b1ba9","chunk-50debbf1":"a21efcfd","chunk-5d7013b8":"ef075d11","chunk-5f425161":"64fa8f60","chunk-5f440c2f":"e1b7042c","chunk-69835417":"f61b867d","chunk-6db783c9":"6e9d7e00","chunk-824041fa":"ac2a0589","chunk-8558012c":"9158d6d4"}[t]+".css",s=c.p+r,i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var u=i[o],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===s))return e()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],l=u.getAttribute("data-href");if(l===r||l===s)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var r=e&&e.target&&e.target.src||s,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete n[t],p.parentNode.removeChild(p),a(i)},p.href=s;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){n[t]=0})));var r=s[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,a){r=s[t]=[e,a]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=o(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(p);var a=s[t];if(0!==a){if(a){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+n+")",d.name="ChunkLoadError",d.type=r,d.request=n,a[1](d)}s[t]=void 0}};var p=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=r,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(a,r,function(e){return t[e]}.bind(null,r));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/twitter-front-end-vue/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var p=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"12ab":function(t,e,a){},"1a86":function(t,e,a){t.exports=a.p+"img/Logo.af0af53b.svg"},"1ee5":function(t,e,a){"use strict";a("9f39")},2375:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spinner"},[a("div",{staticClass:"bouncing-loader"},[a("div"),a("div"),a("div")])])}],s=(a("1ee5"),a("2877")),i={},o=Object(s["a"])(i,r,n,!1,null,"d7e3ff30",null);e["a"]=o.exports},2708:function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"a",(function(){return c}));var r=a("5a0c"),n=a.n(r),s=a("4208"),i=a.n(s),o=(a("5087"),{filters:{fromNow:function(t){return n.a.extend(i.a),t?n()().locale("zh-tw").from(t):"-"}}}),c={filters:{emptyImage:function(t){return t||"https://via.placeholder.com/350x220/DFDFDF?text=No+Image"}}}},"2fa3":function(t,e,a){"use strict";a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return u}));var r=a("3d20"),n=a.n(r),s=a("bc3a"),i=a.n(s),o="https://krll-twitter-api.herokuapp.com/",c=i.a.create({baseURL:o}),u=n.a.mixin({toast:!0,position:"top-end",timer:3e3})},"3d35":function(t,e,a){t.exports=a.p+"img/Home-hovered.7defbdd2.svg"},"40a4":function(t,e,a){},"42ef":function(t,e,a){},"4cce":function(t,e,a){"use strict";var r=a("2fa3"),n=function(){return localStorage.getItem("token")};e["a"]={readUser:function(t){var e=t.id;return r["b"].get("/api/users/".concat(e),{headers:{Authorization:"Bearer ".concat(n())}})},readTweets:function(t){var e=t.id;return r["b"].get("/api/users/".concat(e,"/tweets"),{headers:{Authorization:"Bearer ".concat(n())}})},readLikes:function(t){var e=t.id;return r["b"].get("/api/users/".concat(e,"/likes"),{headers:{Authorization:"Bearer ".concat(n())}})},readRepliedTweets:function(t){var e=t.id;return r["b"].get("/api/users/".concat(e,"/replied_tweets"),{headers:{Authorization:"Bearer ".concat(n())}})},getCurrentUser:function(){return r["b"].get("/api/current_user",{headers:{Authorization:"Bearer ".concat(n())}})},readFollowings:function(t){var e=t.id;return r["b"].get("/api/users/".concat(e,"/followings"),{headers:{Authorization:"Bearer ".concat(n())}})},readFollowers:function(t){var e=t.id;return r["b"].get("/api/users/".concat(e,"/followers"),{headers:{Authorization:"Bearer ".concat(n())}})},updateUser:function(t,e){var a=e.formData;return r["b"].put("/api/users/".concat(t),a,{headers:{Authorization:"Bearer ".concat(n())}})},readTopUsers:function(){return r["b"].get("/api/users/top",{headers:{Authorization:"Bearer ".concat(n())}})}}},"56d7":function(t,e,a){"use strict";a.r(e);a("4160"),a("159b"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"twitter"}},[a("router-view")],1)},s=[],i=(a("4989"),a("ab8b"),{name:"App"}),o=i,c=a("2877"),u=Object(c["a"])(o,n,s,!1,null,null,null),l=u.exports,d=(a("caad"),a("b0c0"),a("d3b7"),a("2532"),a("96cf"),a("1da1")),p=a("8c4f"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h1",[t._v("404 Not Found")])},m=[],v={},h=Object(c["a"])(v,f,m,!1,null,null,null),b=h.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("form",{staticClass:"w-100 d-flex flex-column align-items-center",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[r("img",{staticClass:"alphitterLogo",attrs:{src:a("1a86")}}),r("h5",[t._v("登入 Alphitter")]),r("p",{staticClass:"small text-muted"},[t._v("(可註冊新帳號，或使用帳號:@user1/密碼：12345678登入)")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],staticClass:"form-control",attrs:{type:"text",id:"account",name:"account",placeholder:"帳號",required:"",autofocus:""},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}}),r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"password",name:"password",placeholder:"密碼",required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),r("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" 登入 ")]),r("div",{staticClass:"others d-flex justify-content-end pt-4"},[r("router-link",{attrs:{to:"/signup"}},[t._v("註冊 Alphitter")]),t._v("· "),r("router-link",{attrs:{to:"/admin"}},[t._v("後台登入")])],1)])])},w=[],k=a("7696"),C=a("2fa3"),x={data:function(){return{account:"",password:"",isProcessing:!1}},methods:{handleSubmit:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.account&&t.password){e.next=4;break}return C["a"].fire({icon:"warning",title:"請填入account和password"}),e.abrupt("return");case 4:return t.isProcessing=!0,e.next=7,k["a"].signIn({account:t.account,password:t.password});case 7:if(a=e.sent,r=a.data,"user"===r.user.role){e.next=12;break}return t.$router.push("/admin"),e.abrupt("return");case 12:localStorage.setItem("token",r.token),t.$store.commit("setCurrentUser",r.user),t.$router.push("/main"),e.next=24;break;case 17:e.prev=17,e.t0=e["catch"](0),n=e.t0.response,t.isProcessing=!1,t.password="",C["a"].fire({icon:"error",title:n.data.message}),console.log("response",n);case 24:case"end":return e.stop()}}),e,null,[[0,17]])})))()}}},_=x,y=(a("d14d"),Object(c["a"])(_,g,w,!1,null,"38a54d22",null)),O=y.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"navbar-area",attrs:{id:"navbar-area"}},[a("Navbar")],1),a("div",{staticClass:"main-area",attrs:{id:"main-area"}},[t._m(0),a("main",[a("NewTweet",{attrs:{user:t.presentUser},on:{"after-post-submit":t.afterPostSubmit}}),t.isLoading?a("Spinner"):t._e(),a("div",{staticClass:"tweets-panel"},t._l(t.tweets,(function(e){return a("Tweet",{key:e.id,attrs:{"initial-tweet":e,"initial-user":t.presentUser},on:{"delete-tweet":t.deleteTweet}})})),1)],1)]),a("div",{staticClass:"follow-recommend-area",attrs:{id:"follow-recommend-area"}},[a("FollowRecommend")],1)])},j=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upper-area d-flex align-items-top"},[a("div",{staticClass:"upper-area-content"},[a("strong",{staticClass:"mr-5"},[t._v("首頁")])])])}],U=(a("4de4"),a("2909")),S=a("5530"),P=a("d178"),L=a("5c44"),T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"root new-tweet-area d-flex p-3"},[a("div",{staticClass:"image-area mr-3"},[a("a",[""!==t.currentUser?a("div",{staticClass:"image-cropper"},[a("img",{staticClass:"avatar",attrs:{src:t.currentUser.avatar}})]):t._e()])]),a("div",{staticClass:"content-area w-100"},[a("form",{staticClass:"w-100 d-flex flex-column align-items-end",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"w-100",attrs:{name:"description",id:"text",cols:"20",rows:"1",placeholder:"有什麼新鮮事？"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),a("div",{staticClass:"tweet-num-limit"},[t._v(" "+t._s(t.description.length)+"/140 ")]),t._m(0)])])]),a("div",{staticClass:"divider"}),a("div",{staticClass:"modal fade",attrs:{id:"postModal",tabindex:"-1",role:"dialog","aria-labelledby":"postModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(1),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"modal-new-tweet-area d-flex"},[a("div",{staticClass:"image-area mr-3"},[a("a",[""!==t.currentUser?a("div",{staticClass:"image-cropper"},[a("img",{staticClass:"avatar",attrs:{src:t.currentUser.avatar}})]):t._e()])]),a("div",{staticClass:"content-area w-100"},[a("form",{staticClass:"w-100 d-flex flex-column align-items-end",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"w-100",attrs:{name:"description",id:"description",cols:"20",rows:"4",placeholder:"有什麼新鮮事？"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),a("div",{staticClass:"tweet-num-limit"},[t._v(" "+t._s(t.description.length)+"/140 ")]),a("div",{staticClass:"button-control mt-3"},[a("button",{staticClass:"btn btn-primary post",attrs:{type:"submit",disabled:!t.description}},[t._v(" 推文 ")])])])])])])])])])])},E=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"button-control mt-3"},[a("button",{staticClass:"btn btn-primary post",attrs:{type:"submit"}},[t._v("推文")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[r("img",{attrs:{src:a("61da")}})])])}],R=(a("a4d3"),a("e01a"),a("498a"),a("1157")),$=a.n(R),I={name:"NewTweet",props:{user:{type:Object,required:!0}},data:function(){return{description:"",currentUser:""}},methods:{handleSubmit:function(){if(!this.description.trim())return C["a"].fire({icon:"warning",title:"推文不能為空白"}),void $()("#postModal").modal("hide");var t=this.description;console.log(t),this.$emit("after-post-submit",t),this.description="",$()("#postModal").modal("hide")}},watch:{user:function(t){this.currentUser=Object(S["a"])(Object(S["a"])({},this.currentUser),t)}}},N=I,D=(a("a863"),Object(c["a"])(N,T,E,!1,null,"31e0c4ad",null)),B=D.exports,z=function(){var t=this,e=t.$createElement,r=t._self._c||e;return""!==this.presentUser&&""!==this.tweet.userAvatar?r("div",{staticClass:"tweet-wrapper"},[r("router-link",{staticClass:"router-link",attrs:{to:{name:"reply-list",params:{id:t.tweet.id}}}},[r("div",{staticClass:"tweet d-flex p-2"},[r("div",{staticClass:"image-area mr-3"},[r("router-link",{attrs:{to:{name:"user-profile",params:{id:t.tweet.userId}}}},[r("div",{staticClass:"image-cropper"},[r("img",{staticClass:"avatar",attrs:{src:t.tweet.userAvatar}})])])],1),r("div",{staticClass:"content-area w-100"},[r("div",{staticClass:"post-info d-flex"},[r("router-link",{attrs:{to:{name:"user-profile",params:{id:t.tweet.userId}}}},[r("strong",{staticClass:"name"},[t._v(t._s(t.tweet.userName))])]),r("p",{staticClass:"account ml-1"},[t._v(t._s(t.tweet.userAccount))]),r("p",{staticClass:"created-at"},[t._v("・"+t._s(t._f("fromNow")(t.tweet.createdAt)))]),r("div",{directives:[{name:"show",rawName:"v-show",value:t.presentUser.id===t.tweet.userId,expression:"presentUser.id === tweet.userId"}],staticClass:"setting-control"},[r("div",{ref:"button",staticClass:"dot-wrapper",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleList(e)}}},[r("span",{staticClass:"setting-dot"})])])],1),r("div",{staticClass:"post-content"},[r("p",{staticStyle:{"word-wrap":"break-word"}},[t._v(t._s(t.tweet.description))])]),r("div",{staticClass:"post-engage d-flex"},[r("div",{staticClass:"reply-control d-flex mr-3"},[r("router-link",{attrs:{to:{name:"reply-list",params:{id:t.tweet.id}}}},[r("img",{attrs:{src:a("6211")}})]),r("p",{staticClass:"reply-counts mb-0 ml-2"},[t._v(t._s(t.tweet.repliedCount))])],1),t.isSelfTweet()?t._e():r("div",{staticClass:"like-control d-flex ml-3"},[t.tweet.isLiked?r("img",{staticClass:"like-icon",attrs:{src:a("74bb")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteLike(t.tweet.id)}}}):r("img",{staticClass:"like-icon",attrs:{src:a("cb58")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addLike(t.tweet.id)}}}),t.tweet.isLiked?r("p",{staticClass:"red like-counts mb-0 ml-2"},[t._v(" "+t._s(t.tweet.likedCount)+" ")]):r("p",{staticClass:"like-counts mb-0 ml-2"},[t._v(" "+t._s(t.tweet.likedCount)+" ")])])])])])]),r("div",{directives:[{name:"show",rawName:"v-show",value:t.listPopup,expression:"listPopup"},{name:"closable",rawName:"v-closable",value:{exclude:["button"],handler:"onClose"},expression:"{\n      exclude: ['button'],\n      handler: 'onClose',\n    }"}],staticClass:"list-wrapper"},[r("div",{staticClass:"list-group setting-list"},[t._m(0),r("button",{staticClass:"list-group-item list-item delete-tweet d-flex align-items-center",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteTweet(t.tweet.id)}}},[r("img",{staticClass:"list-icon",attrs:{src:a("8cfb")}}),r("p",{staticClass:"mb-0"},[t._v("刪除")])])])]),r("div",{staticClass:"modal fade",attrs:{id:"editTweetModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[t._m(1),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"user-related d-flex"},[r("div",{staticClass:"image-area mr-3"},[r("div",{staticClass:"image-cropper"},[r("img",{staticClass:"avatar",attrs:{src:t.tweet.userAvatar}})])]),r("div",{staticClass:"post-info d-flex"},[r("strong",{staticClass:"name"},[t._v(t._s(t.tweet.userName))]),r("p",{staticClass:"account ml-1"},[t._v(t._s(t.tweet.userAccount))]),r("p",{staticClass:"created-at"},[t._v("・"+t._s(t._f("fromNow")(t.tweet.createdAt)))])])]),r("form",[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tweet.description,expression:"tweet.description"}],staticClass:"w-100 mt-3",attrs:{name:"description",id:"description",cols:"20",rows:"4"},domProps:{value:t.tweet.description},on:{input:function(e){e.target.composing||t.$set(t.tweet,"description",e.target.value)}}}),r("button",{staticClass:"save-edit btn btn-primary btn-block",attrs:{type:"submit"}},[t._v(" 儲存 ")])])])])])])],1):t._e()},F=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("button",{staticClass:"btn list-group-item list-item edit-tweet d-flex align-items-center",attrs:{type:"button","data-toggle":"modal","data-target":"#editTweetModal"}},[r("img",{staticClass:"list-icon",attrs:{src:a("d9ae")}}),r("p",{staticClass:"mb-0"},[t._v("編輯")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"editTweetModalLabel"}},[t._v("編輯推文")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],M=a("2708"),q=a("c058"),K={name:"Tweet",props:{initialTweet:{type:Object,required:!0},initialUser:{type:Object,required:!0}},mixins:[M["b"]],data:function(){return{tweet:{id:-1,userId:-1,description:"",createdAt:"",userName:"",userAccount:"",userAvatar:"",repliedCount:-1,likedCount:-1,isLiked:!1},listPopup:!1,presentUser:this.initialUser}},methods:{fetchData:function(){var t=this.initialTweet,e=t.id,a=t.UserId,r=t.User,n=t.description,s=t.createdAt,i=t.repliedCount,o=t.LikeCount,c=t.isLiked,u=r.name,l=r.account,d=r.avatar;this.tweet=Object(S["a"])(Object(S["a"])({},this.tweet),{},{id:e,userId:a,description:n,createdAt:s,userName:u,userAccount:l,userAvatar:d,repliedCount:i,likedCount:o,isLiked:c})},addLike:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,q["a"].like({tweetId:t});case 3:r=a.sent,console.log(r),e.tweet=Object(S["a"])(Object(S["a"])({},e.tweet),{},{isLiked:!0,likedCount:e.tweet.likedCount+1}),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](0),console.log(a.t0),C["a"].fire({icon:"error",title:"無法點擊愛心，請稍後再試"});case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))()},deleteLike:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,q["a"].unlike({tweetId:t});case 3:r=a.sent,console.log(r),e.tweet=Object(S["a"])(Object(S["a"])({},e.tweet),{},{isLiked:!1,likedCount:e.tweet.likedCount-1}),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](0),console.log("error:",a.t0),C["a"].fire({icon:"error",title:"暫時無法收回愛心，請稍候再試！"});case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))()},toggleList:function(){this.listPopup=!this.listPopup},onClose:function(){this.listPopup=!1},isSelfTweet:function(){return this.presentUser.id===this.tweet.userId},deleteTweet:function(t){this.$emit("delete-tweet",t)}},created:function(){this.fetchData()},watch:{tweet:function(t){this.tweet=t}}},H=K,J=(a("83a7"),Object(c["a"])(H,z,F,!1,null,"72b896da",null)),G=J.exports,Q=a("2f62"),V=a("6783"),W=a("2375"),X=a("4cce"),Y={name:"Main",components:{Navbar:P["a"],FollowRecommend:L["a"],NewTweet:B,Tweet:G,Spinner:W["a"]},computed:Object(S["a"])({},Object(Q["b"])(["currentUser","isAuthenticated"])),data:function(){return{tweets:[],presentUser:{},isLoading:!1}},methods:{fetchData:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoading=!0,e.next=4,V["a"].readAll();case 4:a=e.sent,r=a.data,t.tweets=Object(U["a"])(r),t.isLoading=!1,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),t.isLoading=!1,console.log("error:",e.t0),C["a"].fire({icon:"error",title:"暫時無法取得所有推文，請稍候再試！"});case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))()},afterPostSubmit:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,V["a"].post({description:t});case 3:r=a.sent,n=r.data,console.log(n),e.tweets.unshift({id:n.tweet.id,description:t,User:e.presentUser,UserId:e.presentUser.id,createdAt:new Date,isLiked:!1,repliedCount:0,LikeCount:0}),e.fetchData(),e.fetchCurrentUser(),a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](0),console.log("error:",a.t0),C["a"].fire({icon:"error",title:"暫時無法新增推文，請稍候再試！"});case 15:case"end":return a.stop()}}),a,null,[[0,11]])})))()},fetchCurrentUser:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X["a"].getCurrentUser();case 3:if(a=e.sent,"OK"===a.statusText){e.next=6;break}throw new Error(a.statusText);case 6:r=a.data,t.presentUser=Object(S["a"])(Object(S["a"])({},t.presentUser),r),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log("error:",e.t0),C["a"].fire({icon:"error",title:"暫時無法取得當前用戶資料，請稍候！"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()},deleteTweet:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,V["a"].delete(t);case 3:r=a.sent,console.log(r),e.tweets=e.tweets.filter((function(e){return e.id!==t})),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](0),console.log("error:",a.t0),C["a"].fire({icon:"error",title:"暫時無法刪除推文，請稍候再試！"});case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))()}},created:function(){this.fetchData(),this.fetchCurrentUser()}},Z=Y,tt=(a("8692"),Object(c["a"])(Z,A,j,!1,null,"6bc93d4e",null)),et=tt.exports;r["a"].use(Q["a"]);var at=new Q["a"].Store({state:{currentUser:{id:-1,email:"",password:"",name:"",avatar:"",introduction:"",account:"",cover:"",role:"",createdAt:"",updatedAt:""},isAuthenticated:!1,token:""},mutations:{setCurrentUser:function(t,e){t.currentUser=Object(S["a"])(Object(S["a"])({},t.currentUser),e),t.token=localStorage.getItem("token"),t.isAuthenticated=!0},revokeAuthentication:function(t){t.currentUser={},t.isAuthenticated=!1,t.token="",localStorage.removeItem("token")}},actions:{fetchCurrentUser:function(t){return Object(d["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s,i,o,c,u,l,d,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.commit,e.prev=1,e.next=4,X["a"].getCurrentUser();case 4:if(r=e.sent,n=r.data,s=r.statusText,i=n.id,o=n.email,c=n.name,u=n.avatar,l=n.introduction,d=n.account,p=n.cover,f=n.role,"OK"===s){e.next=10;break}throw new Error(s);case 10:return a("setCurrentUser",{id:i,email:o,name:c,avatar:u,introduction:l,account:d,cover:p,role:f}),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e["catch"](1),console.log("error",e.t0),console.error("can not fetch user information"),a("revokeAuthentication"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[1,14]])})))()}},modules:{}});r["a"].use(p["a"]);var rt=[{path:"/tweet/:id/reply-list",name:"reply-list",component:function(){return a.e("chunk-5f425161").then(a.bind(null,"9aeb"))}},{path:"/admin/users",name:"admin-users",component:function(){return a.e("chunk-5d7013b8").then(a.bind(null,"6135"))}},{path:"/admin/main",name:"admin-main",component:function(){return a.e("chunk-1933fae3").then(a.bind(null,"4c90"))}},{path:"/admin/login",name:"admin",component:function(){return a.e("chunk-2916cf79").then(a.bind(null,"3530"))}},{path:"/admin",exact:!0,redirect:"/admin/login"},{path:"/",name:"root",redirect:"/signin"},{path:"/signin",name:"sign-in",component:O},{path:"/signup",name:"sign-up",component:function(){return a.e("chunk-50debbf1").then(a.bind(null,"5c9c"))}},{path:"/main",name:"main-tweets",component:et},{path:"/user/setting",name:"user-setting",component:function(){return a.e("chunk-288c86ad").then(a.bind(null,"ce99"))}},{path:"/user/chatting/public",name:"public-chat",component:function(){return a.e("chunk-6db783c9").then(a.bind(null,"505d"))}},{path:"/user/chatting/:id",name:"private-chat",component:function(){return a.e("chunk-69835417").then(a.bind(null,"72cc"))}},{path:"/user/profile/:id/:category?",name:"user-profile",component:function(){return a.e("chunk-8558012c").then(a.bind(null,"4a39"))}},{path:"/user/:id/:followship",exact:!0,name:"user-followlist",component:function(){return a.e("chunk-824041fa").then(a.bind(null,"09b4"))}},{path:"/chatroom",name:"chatroom",component:function(){return a.e("chunk-5f440c2f").then(a.bind(null,"3519"))}},{path:"*",name:"not-found",component:b}],nt=new p["a"]({linkExactActiveClass:"active",routes:rt});nt.beforeEach(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e,a,r){var n,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=localStorage.getItem("token"),s=at.state.token,i=at.state.isAuthenticated,!n||n===s){t.next=7;break}return t.next=6,at.dispatch("fetchCurrentUser");case 6:i=t.sent;case 7:if(!i||"sign-in"!==e.name){t.next=10;break}return r("/main/"),t.abrupt("return");case 10:if(o=["sign-up","sign-in","admin"],i||o.includes(e.name)){t.next=14;break}return r("/signin"),t.abrupt("return");case 14:if(!i||!o.includes(e.name)){t.next=17;break}return r("/main"),t.abrupt("return");case 17:r();case 18:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}());var st=nt,it=(a("12ab"),a("8e27")),ot=a.n(it);r["a"].config.productionTip=!1;var ct,ut=ot()("https://krll-twitter-api-dev.herokuapp.com/",{withCredentials:!0,extraHeaders:{"my-custom-header":"my-custom-header"}});r["a"].use(ut),r["a"].directive("closable",{bind:function(t,e,a){ct=function(r){r.stopPropagation();var n=e.value,s=n.exclude,i=n.handler,o=!1;s.forEach((function(t){if(!o){var e=a.context.$refs[t];o=e.contains(r.target)}})),t.contains(r.target)||o||a.context[i]()},document.addEventListener("click",ct),document.addEventListener("touchstart",ct)},unbind:function(){document.removeEventListener("click",ct),document.removeEventListener("touchstart",ct)}}),new r["a"]({router:st,store:at,render:function(t){return t(l)}}).$mount("#app")},5896:function(t,e,a){t.exports=a.p+"img/Home.6405757d.svg"},"5c44":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[t._m(0),a("div",{staticClass:"card-body"},t._l(t.recommends,(function(e){return a("div",{key:e.id,staticClass:"recommend"},[a("router-link",{staticClass:"d-flex",attrs:{to:{name:"user-profile",params:{id:e.id}}}},[a("div",{staticClass:"info d-flex align-items-center"},[a("div",{staticClass:"image-area mr-2"},[a("div",{staticClass:"image-cropper"},[a("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.avatar)}})])]),a("div",{staticClass:"info-text d-flex flex-column justify-content-center"},[a("strong",{staticClass:"name"},[t._v(t._s(e.name))]),a("p",{staticClass:"account"},[t._v(t._s(e.account))])])]),a("div",{staticClass:"follow-badge ml-auto"},[e.isFollowed?a("div",{staticClass:"following badge badge-pill badge-primary"},[t._v(" 正在跟隨 ")]):t._e(),e.isFollowed?a("div",{staticClass:"deleteFollow badge badge-pill",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.unfollow(e)}}},[t._v(" 取消跟隨 ")]):a("div",{staticClass:"unfollow badge badge-pill badge-outline-primary",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.follow(e)}}},[t._v(" 跟隨 ")])])])],1)})),0),t.recommendsAllShowed?t._e():a("div",{staticClass:"card-footer more",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.showAllRecommends(e)}}},[t._v(" 顯示更多 ")])])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-header"},[a("strong",[t._v("跟隨誰")])])}],s=(a("4de4"),a("c975"),a("2909")),i=(a("96cf"),a("1da1")),o=a("4cce"),c=a("b025"),u=a("2fa3"),l=a("2708"),d={data:function(){return{recommends:[],recommendsAllShowed:!1}},mixins:[l["a"]],methods:{fetchData:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o["a"].readTopUsers();case 3:if(r=a.sent,"OK"===r.statusText){a.next=6;break}throw new Error(r.statusText);case 6:n=r.data,e.recommends=Object(s["a"])(n).filter((function(e,a,r){return r.indexOf(e)<t})),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log(a.t0),u["a"].fire({icon:"error",title:"無法取得推薦名單，請稍後再試"});case 14:case"end":return a.stop()}}),a,null,[[0,10]])})))()},showAllRecommends:function(){this.recommendsAllShowed=!0,this.fetchData(10)},follow:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,r=t.id,console.log(r),a.next=5,c["a"].follow({id:r});case 5:if(n=a.sent,"OK"===n.statusText){a.next=8;break}throw new Error(n.statusText);case 8:t.isFollowed=!0,e.recommends=Object(s["a"])(e.recommends),e.$emit("after-click-follow",t),a.next=17;break;case 13:a.prev=13,a.t0=a["catch"](0),console.log(a.t0),u["a"].fire({icon:"error",title:"無法成功跟隨，請稍後再試"});case 17:case"end":return a.stop()}}),a,null,[[0,13]])})))()},unfollow:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,r=t.id,a.next=4,c["a"].unfollow({id:r});case 4:if(n=a.sent,"OK"===n.statusText){a.next=7;break}throw new Error(n.statusText);case 7:t.isFollowed=!1,e.recommends=Object(s["a"])(e.recommends),e.$emit("after-click-unfollow",t),a.next=16;break;case 12:a.prev=12,a.t0=a["catch"](0),console.log(a.t0),u["a"].fire({icon:"error",title:"無法成功跟隨，請稍後再試"});case 16:case"end":return a.stop()}}),a,null,[[0,12]])})))()}},created:function(){this.fetchData(6)}},p=d,f=(a("bd16"),a("2877")),m=Object(f["a"])(p,r,n,!1,null,"381041f2",null);e["a"]=m.exports},"61da":function(t,e,a){t.exports=a.p+"img/Close.b7a5aa40.svg"},6211:function(t,e,a){t.exports=a.p+"img/Reply.17ee81ba.svg"},6278:function(t,e,a){},6783:function(t,e,a){"use strict";a("a4d3"),a("e01a");var r=a("2fa3"),n=function(){return localStorage.getItem("token")};e["a"]={readAll:function(){return r["b"].get("/api/tweets",{headers:{Authorization:"Bearer ".concat(n())}})},read:function(t){return r["b"].get("/api/tweets/".concat(t),{headers:{Authorization:"Bearer ".concat(n())}})},post:function(t){var e=t.description;return r["b"].post("/api/tweets",{description:e},{headers:{Authorization:"Bearer ".concat(n())}})},update:function(t,e){var a=e.description;return r["b"].put("/api/tweets/".concat(t),{description:a},{headers:{Authorization:"Bearer ".concat(n())}})},delete:function(t){return r["b"].delete("/api/tweets/".concat(t),{headers:{Authorization:"Bearer ".concat(n())}})}}},"74bb":function(t,e,a){t.exports=a.p+"img/Like-liked.12d69306.svg"},7696:function(t,e,a){"use strict";a("b0c0");var r=a("2fa3");e["a"]={adminSignIn:function(t){var e=t.account,a=t.password;return r["b"].post("/api/login",{account:e,password:a})},signIn:function(t){var e=t.account,a=t.password;return r["b"].post("/api/login",{account:e,password:a})},signUp:function(t){var e=t.account,a=t.name,n=t.email,s=t.password,i=t.checkPassword;return r["b"].post("/api/users",{account:e,name:a,email:n,password:s,checkPassword:i})}}},"83a7":function(t,e,a){"use strict";a("8486")},8486:function(t,e,a){},8692:function(t,e,a){"use strict";a("6278")},"8cfb":function(t,e,a){t.exports=a.p+"img/Trash-can.e8aad7f2.svg"},"8ec2":function(t,e,a){t.exports=a.p+"img/User-hovered.dcb8bd80.svg"},"96b4":function(t,e,a){"use strict";a("d611")},"9f39":function(t,e,a){},a863:function(t,e,a){"use strict";a("40a4")},a92b:function(t,e,a){t.exports=a.p+"img/Setting.af8208eb.svg"},b025:function(t,e,a){"use strict";var r=a("2fa3"),n=function(){return localStorage.getItem("token")};e["a"]={follow:function(t){var e=t.id;return r["b"].post("/api/followships",{id:e},{headers:{Authorization:"Bearer ".concat(n())}})},unfollow:function(t){var e=t.id;return r["b"].delete("/api/followships/".concat(e),{headers:{Authorization:"Bearer ".concat(n())}})}}},b0255:function(t,e,a){},bd16:function(t,e,a){"use strict";a("42ef")},c058:function(t,e,a){"use strict";var r=a("2fa3"),n=function(){return localStorage.getItem("token")};e["a"]={like:function(t){var e=t.tweetId;return r["b"].post("/api/tweets/".concat(e,"/like"),null,{headers:{Authorization:"Bearer ".concat(n())}})},unlike:function(t){var e=t.tweetId;return r["b"].post("/api/tweets/".concat(e,"/unlike"),null,{headers:{Authorization:"Bearer ".concat(n())}})}}},cb58:function(t,e,a){t.exports=a.p+"img/Like.f11fe57a.svg"},cf4a:function(t,e,a){t.exports=a.p+"img/User.488ca584.svg"},d14d:function(t,e,a){"use strict";a("b0255")},d178:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{staticClass:"sidebar",staticStyle:{height:"100%"}},[r("div",{staticClass:"sidebar-sticky d-flex flex-column",staticStyle:{height:"100%"}},[r("div",{staticClass:"top-area"},[r("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[r("img",{attrs:{src:a("1a86")}})]),r("div",{staticClass:"nav-list"},[r("router-link",{staticClass:"nav-item",attrs:{to:"/main"}},[r("div",{staticClass:"d-flex",staticStyle:{width:"115px"}},[r("img",{staticClass:"icon",attrs:{src:a("5896")}}),r("img",{staticClass:"icon-hovered",attrs:{src:a("3d35")}}),r("p",[t._v("首頁")])])]),r("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-profile",params:{id:t.currentUser.id}}}},[r("div",{staticClass:"d-flex",staticStyle:{width:"143px"}},[r("img",{staticClass:"icon",attrs:{src:a("cf4a")}}),r("img",{staticClass:"icon-hovered",attrs:{src:a("8ec2")}}),r("p",[t._v("個人資料")])])]),r("router-link",{staticClass:"nav-item",attrs:{to:"/user/setting"}},[r("div",{staticClass:"d-flex",staticStyle:{width:"115px"}},[r("img",{staticClass:"icon",attrs:{src:a("a92b")}}),r("img",{staticClass:"icon-hovered",attrs:{src:a("f934")}}),r("p",[t._v("設定")])])])],1),r("div",{staticClass:"btn btn-primary post",attrs:{type:"button","data-toggle":"modal","data-target":"#postModal"},on:{click:t.handleClickConfig}},[t._v(" 推文 ")])],1),r("div",{staticClass:"bottom-area mt-auto"},[r("div",{staticClass:"signout-wrapper d-flex",staticStyle:{width:"115px"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSignOut(e)}}},[r("img",{staticClass:"icon",attrs:{src:a("f300")}}),r("p",[t._v("登出")])])])])])},n=[],s=a("5530"),i=a("2f62"),o={name:"Navbar",components:{},computed:Object(s["a"])({},Object(i["b"])(["currentUser","isAuthenticated"])),methods:{handleSignOut:function(){this.$store.commit("revokeAuthentication"),this.$router.push("/signin")},handleClickConfig:function(){this.$router.push({name:"main-tweets"})}}},c=o,u=(a("96b4"),a("2877")),l=Object(u["a"])(c,r,n,!1,null,"aac9718e",null);e["a"]=l.exports},d611:function(t,e,a){},d9ae:function(t,e,a){t.exports=a.p+"img/Edit.70454fa7.svg"},f300:function(t,e,a){t.exports=a.p+"img/Signout.b18c7e38.svg"},f934:function(t,e,a){t.exports=a.p+"img/Setting-hovered.18e82df1.svg"}});
//# sourceMappingURL=app.679fcf90.js.map