(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f425161"],{"32df":function(e,t,a){"use strict";a("b044")},5472:function(e,t,a){},"6c6d":function(e,t,a){"use strict";a("b064")},"92ee":function(e,t,a){"use strict";a("5472")},"9aeb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container d-flex"},[a("div",{staticClass:"navbar-area",attrs:{id:"navbar-area"}},[a("Navbar")],1),a("div",{staticClass:"main"},[a("div",{staticClass:"main-title d-flex"},[a("router-link",{staticClass:"arrow",attrs:{to:{name:"main-tweets"}}}),a("div",{staticClass:"title"},[e._v("推文")])],1),a("div",{staticClass:"tweet-detail-container"},[-1!==e.tweet.id?a("TweetDetail",{attrs:{user:e.user,"initial-tweet":e.tweet,"initial-user":e.user},on:{"after-post-submit":e.afterPostSubmit}}):e._e()],1),a("div",{staticClass:"tweet-reply-container"},[e.replies.length<1?a("h5",{staticClass:"no-reply"},[e._v(" 本推文目前沒有回覆Q__Q ")]):e._e(),e._l(e.replies,(function(t){return a("TweetReply",{key:t.id,attrs:{"initial-reply":t,"initial-user":e.user,tweet:e.tweet}})}))],2)]),a("div",{staticClass:"follow-recommend-area",attrs:{id:"follow-recommend-area"}},[a("FollowRecommend")],1)])},r=[],i=(a("b0c0"),a("2909")),n=(a("96cf"),a("1da1")),c=a("5530"),l=a("d178"),o=a("5c44"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"reply-container"},[a("div",{staticClass:"reply-template d-flex"},[a("div",{staticClass:"image-cropper"},[a("img",{staticClass:"avatar",attrs:{src:e._f("emptyImage")(e.initialReply.User.avatar)}})]),a("div",{staticClass:"reply-all"},[a("div",{staticClass:"user-profile d-flex"},[a("div",{staticClass:"user-name"},[e._v(e._s(e.initialReply.User.name))]),a("div",{staticClass:"user-account"},[e._v(e._s(e.initialReply.User.account))]),a("div",{staticClass:"dot"},[e._v("・")]),a("div",{staticClass:"createdAt"},[e._v(" "+e._s(e._f("fromNow")(e.initialReply.createdAt))+" ")])]),a("div",{staticClass:"user-reply d-flex"},[a("div",{staticClass:"reply-literal"},[e._v("回覆")]),a("div",{staticClass:"reply-account"},[e._v(e._s(e.tweet.User.account))])]),a("div",{staticClass:"reply-content"},[e._v(e._s(e.initialReply.comment))])])])])},d=[],p=a("2708"),m={name:"TweetReply",mixins:[p["b"],p["a"]],data:function(){return{}},props:{initialReply:{type:Object,required:!0},initialUser:{type:Object,required:!0},tweet:{type:Object,required:!0}}},v=m,f=(a("6c6d"),a("2877")),w=Object(f["a"])(v,u,d,!1,null,"0c8ac4c2",null),C=w.exports,h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"detail-container"},[s("div",{staticClass:"tweet-container"},[s("div",{staticClass:"user-info-container d-flex"},[s("div",{staticClass:"image-cropper"},[s("img",{staticClass:"avatar",attrs:{src:e.presentTweet.User.avatar,alt:"user-pic"}})]),s("div",{staticClass:"user-info-context"},[s("div",{staticClass:"user-name"},[e._v(e._s(e.presentTweet.User.name))]),s("div",{staticClass:"user-account"},[e._v(e._s(e.presentTweet.User.account))])])]),s("div",{staticClass:"tweet-content"},[e._v(" "+e._s(e.presentTweet.description)+" ")]),s("div",{staticClass:"tweet-time d-flex"},[s("div",{staticClass:"tweet-date"},[e._v(e._s(e._f("fromNow")(e.presentTweet.createdAt)))])])]),s("div",{staticClass:"status-container d-flex"},[s("div",{staticClass:"reply-number"},[e._v(e._s(e.presentTweet.repliedCount))]),s("div",{staticClass:"reply"},[e._v("回覆")]),s("div",{staticClass:"like-number"},[e._v(e._s(e.presentTweet.LikeCount))]),s("div",{staticClass:"like"},[e._v("喜歡次數")])]),s("div",{staticClass:"reation-container d-flex"},[e._m(0),""===this.presentUser||e.isSelfTweet()?e._e():s("div",{staticClass:"like-icon"},[e.presentTweet.isLiked?s("img",{staticClass:"like-img",attrs:{src:a("74bb")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.presentTweet.id)}}}):s("img",{staticClass:"like-img",attrs:{src:a("cb58")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.presentTweet.id)}}})])]),s("div",{staticClass:"modal fade",attrs:{id:"postReply",tabindex:"-1",role:"dialog","aria-labelledby":"postReplyLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[e._m(1),s("div",{staticClass:"modal-body d-flex"},[s("div",{staticClass:"m-reply-all d-flex"},[s("div",{staticClass:"m-reply-container d-flex"},[s("div",{staticClass:"m-reply-photo-area"},[s("img",{staticClass:"m-reply-to-photo",attrs:{src:e.presentTweet.User.avatar,alt:""}}),s("div",{staticClass:"m-reply-line"}),s("img",{staticClass:"m-reply-photo",attrs:{src:e.presentUser.avatar,alt:""}})]),s("div",{staticClass:"reply-content-area"},[s("div",{staticClass:"m-reply-post-info d-flex"},[s("strong",{staticClass:"m-reply-name"},[e._v(e._s(e.presentTweet.User.name))]),s("p",{staticClass:"m-reply-account"},[e._v(" "+e._s(e.presentTweet.User.account)+" ")]),s("p",{staticClass:"m-reply-created-at"},[e._v("・3小時")])]),s("div",{staticClass:"m-reply-post-content"},[s("p",{staticClass:"m-p"},[e._v(" "+e._s(e.presentTweet.description)+" ")]),s("div",{staticClass:"m-reply-to-container d-flex"},[s("div",{staticClass:"m-reply-to"},[e._v("回覆給")]),s("div",{staticClass:"m-reply-to-account"},[e._v(" "+e._s(e.presentTweet.User.account)+" ")])]),s("form",{staticClass:"w-100 d-flex flex-column align-items-end",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newReply,expression:"newReply"}],staticClass:"w-100",attrs:{name:"comment",id:"text",cols:"20",rows:"6",placeholder:"推你的回覆"},domProps:{value:e.newReply},on:{input:function(t){t.target.composing||(e.newReply=t.target.value)}}}),e._m(2)])])])])])])])])])])},b=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"reply-icon"},[s("a",{attrs:{href:"#myModal",role:"button","data-toggle":"modal","data-target":"#postReply"}},[s("img",{staticClass:"reply-img",attrs:{src:a("6211")}})])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-header"},[s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("img",{attrs:{src:a("61da")}})])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"button-control mt-3"},[a("button",{staticClass:"btn btn-primary post",attrs:{type:"submit"}},[e._v(" 回覆 ")])])}],y=(a("498a"),a("1157")),_=a.n(y),g=a("c058"),x=a("2fa3"),R={name:"TweetDetail",mixins:[p["b"]],props:{initialTweet:{type:Object,required:!0},initialUser:{type:Object,required:!0}},data:function(){return{newReply:"",presentUser:this.initialUser,presentTweet:this.initialTweet,isLoading:!0}},methods:{handleSubmit:function(){if(!this.newReply.trim())return x["a"].fire({icon:"warning",title:"回覆不能空白"}),void _()("#postReply").modal("hide");var e=this.newReply;this.$emit("after-post-submit",e),console.log(e),this.newReply="",_()("#postReply").modal("hide")},addLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g["a"].like({tweetId:e});case 3:s=a.sent,console.log(s),t.presentTweet=Object(c["a"])(Object(c["a"])({},t.presentTweet),{},{isLiked:!0,LikeCount:t.presentTweet.LikeCount+1}),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](0),console.log("error:",a.t0),x["a"].fire({icon:"error",title:'暫時無法愛上，請稍候>"<'});case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))()},deleteLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g["a"].unlike({tweetId:e});case 3:s=a.sent,console.log(s),t.presentTweet=Object(c["a"])(Object(c["a"])({},t.presentTweet),{},{isLiked:!1,LikeCount:t.presentTweet.LikeCount-1}),a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](0),console.log("error:",a.t0),x["a"].fire({icon:"error",title:'暫時無法收回愛心，請稍候>"<'});case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))()},isSelfTweet:function(){return this.presentUser.id===this.presentTweet.UserId}},watch:{initialTweet:function(e){console.log({newValue:e}),this.presentTweet=Object(c["a"])(Object(c["a"])({},this.presentTweet),e)}}},k=R,T=(a("32df"),Object(f["a"])(k,h,b,!1,null,"78bef611",null)),U=T.exports,O=function(){return localStorage.getItem("token")},j={getReply:function(e){return x["b"].get("/api/tweets/".concat(e,"/replies"),{headers:{Authorization:"Bearer ".concat(O())}})},addReply:function(e,t){var a=t.comment;return x["b"].post("/api/tweets/".concat(e,"/replies"),{comment:a},{headers:{Authorization:"Bearer ".concat(O())}})}},L=a("6783"),A=a("4cce"),$=a("2f62"),D={name:"MainTweetsReplyList",components:{Navbar:l["a"],FollowRecommend:o["a"],TweetReply:C,TweetDetail:U},data:function(){return{user:{},tweet:{id:-1,UserId:-1,description:"",createdAt:"",updatedAt:"",User:{id:-1,account:"",name:"",avatar:""},isLiked:!1,repliedCount:0,LikeCount:0,isSelf:!1},replies:[]}},beforeRouteUpdate:function(e,t,a){var s=e.params.id;this.fetchTweet(s),this.fetchReply(s),a()},created:function(){var e=this.$route.params.id;this.fetchTweet(e);var t=this.$route.params.id;this.fetchReply(t),this.fetchCurrentUser()},computed:Object(c["a"])({},Object($["b"])(["currentUser","isAuthenticated"])),methods:{fetchTweet:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,L["a"].read(e);case 3:s=a.sent,r=s.data,t.tweet=r,a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](0),console.log("error:",a.t0),x["a"].fire({icon:"error",title:"暫時無法取得推文細節，請稍候再試！"});case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))()},fetchReply:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r,n,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,j.getReply(e);case 3:s=a.sent,r=s.data,t.replies=Object(i["a"])(r),a.next=18;break;case 8:return a.prev=8,a.t0=a["catch"](0),console.log("error:",a.t0),a.next=13,j.getReply(e);case 13:if(n=a.sent,c=n.data,0!==c.length){a.next=17;break}return a.abrupt("return");case 17:x["a"].fire({icon:"error",title:"暫時無法取得推文回覆，請稍候再試！"});case 18:case"end":return a.stop()}}),a,null,[[0,8]])})))()},fetchCurrentUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A["a"].getCurrentUser();case 3:if(a=t.sent,"OK"===a.statusText){t.next=6;break}throw new Error(a.statusText);case 6:s=a.data,e.user=Object(c["a"])(Object(c["a"])({},e.user),s),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log("error:",t.t0),x["a"].fire({icon:"error",title:"暫時無法取得用戶資料，請稍等！"});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},afterPostSubmit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,s=t.$route.params.id,a.next=4,j.addReply(s,{comment:e});case 4:if(r=a.sent,"OK"===r.statusText){a.next=7;break}throw new Error(r.message);case 7:i=r.id,t.replies.unshift({id:i,TweetId:s,UserId:t.user.id,createdAt:new Date,updateAt:new Date,comment:e,User:{account:t.user.account,avatar:t.user.avatar,name:t.user.name}}),t.tweet.repliedCount++,a.next=16;break;case 12:a.prev=12,a.t0=a["catch"](0),console.log("error:",a.t0),x["a"].fire({icon:"error",title:"暫時無法新增回覆，請稍候再試！"});case 16:case"end":return a.stop()}}),a,null,[[0,12]])})))()}}},E=D,I=(a("92ee"),Object(f["a"])(E,s,r,!1,null,"b5d64b44",null));t["default"]=I.exports},b044:function(e,t,a){},b064:function(e,t,a){}}]);
//# sourceMappingURL=chunk-5f425161.c20ad53c.js.map